import jayson from 'jayson/promise/index.js'
import { ProtocolId } from 'portalnetwork'

const sampleReceipt = {
    hash: "0x45db80e2ea872275e74d64791987302295ade08ac6805aae6f2e8474bfce2a4d",
    rawReceipt: "0x02f906710183026deab90100002000400000000000000000c000000100000000000000000001100000000000000000000000000000000000000000000200000008000000000000004020000000000000000000000000000c000000200000000000000000000100000000000000000000000000000000000000000000000000000000000000000010000000000000000000000002004000000000000000000000000080080000004000000000020000000010000000000000000000000000000000400000020000000000000000000002000400200000008084000400000000000000001000000000000020000010200000000000000000000000000002000040000000000000000000000000f90566f89b942f4eb47a1b1f4488c71fc10e39a4aa56af33dd49f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000ccc4dcd160e49584ca8657f39d2a2f59ef520affa000000000000000000000000043fdbee01a1f6698766a51a69d4a849ec09cbe81a000000000000000000000000000000000000000000000000ad78ebc5ac6200000f89b942f4eb47a1b1f4488c71fc10e39a4aa56af33dd49f863a08c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925a0000000000000000000000000ccc4dcd160e49584ca8657f39d2a2f59ef520affa00000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488da0ffffffffffffffffffffffffffffffffffffffffffffff83324e625048454e19f89b94c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa000000000000000000000000043fdbee01a1f6698766a51a69d4a849ec09cbe81a000000000000000000000000001962144d41415cca072900fe87bbe2992a99f10a0000000000000000000000000000000000000000000000000154b4651b0e10dadf8799443fdbee01a1f6698766a51a69d4a849ec09cbe81e1a01c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1b84000000000000000000000000000000000000000000000015bc8a0356a5749d9e700000000000000000000000000000000000000000000000297c11ec558241856f8fc9443fdbee01a1f6698766a51a69d4a849ec09cbe81f863a0d78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822a00000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488da000000000000000000000000001962144d41415cca072900fe87bbe2992a99f10b88000000000000000000000000000000000000000000000000ad78ebc5ac620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000154b4651b0e10dadf89b9440fd72257597aa14c7231a7b1aaa29fce868f677f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa000000000000000000000000001962144d41415cca072900fe87bbe2992a99f10a0000000000000000000000000ccc4dcd160e49584ca8657f39d2a2f59ef520affa00000000000000000000000000000000000000000000000206d0478b8f4de503ef8799401962144d41415cca072900fe87bbe2992a99f10e1a01c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1b8400000000000000000000000000000000000000000000002503e283bc9eb189ba1000000000000000000000000000000000000000000000001990d887c9461a8ddf8fc9401962144d41415cca072900fe87bbe2992a99f10f863a0d78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822a00000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488da0000000000000000000000000ccc4dcd160e49584ca8657f39d2a2f59ef520affb8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000154b4651b0e10dad0000000000000000000000000000000000000000000000206d0478b8f4de503e0000000000000000000000000000000000000000000000000000000000000000"
  }

const main = async () => {
  const nodeA = jayson.Client.http({ host: '127.0.0.1', port: 8546 })
  const nodeAEnr = await nodeA.request('portal_nodeEnr', [])
  console.log(nodeAEnr)
  const nodeB = jayson.Client.http({ host: '127.0.0.1', port: 8545 })
  const nodeBENR = await nodeB.request('portal_nodeEnr', [])
  console.log(nodeBENR)

  const addReceipt = await nodeA.request('portal_addReceiptToHistory', [sampleReceipt.rawReceipt, sampleReceipt.hash])
    console.log(addReceipt)

const ping = await nodeB.request('portal_ping', [nodeAEnr.result, ProtocolId.HistoryNetwork])
console.log(ping)

    const getReceipt = await nodeB.request('eth_getTransactionReceipt', [sampleReceipt.hash])
    console.log(getReceipt)
  
}
main()
